#Directories:

Validator module: 		blockfin/validator
Messagenode module: 	blockfin/messagenode

#Prerequisites:

- Node.js version 8.11 or higher.
- NPM version 5.6.0 or higher.

#Setup:

- In each of the above directories, run `npm install`. This will install the required modules.

#On validator side (`cd blockfin/validator`):

1. node secrets.js - produces ./validator-config.json
2. node setup-validator.js & - sets up and runs all the validator pub servers
3. node setup-roles-as-feed.js - sets up different roles validator can take as a feed, so Messagenodes can follow them
4. node invite.js - create invitations for Messagenodes. Produces validator-invites.json. Copy this file to “message node” folder

#On Messagenode side (`cd blockfin/messagenode`):

1. node secrets.js - produces ./messagenode-config.json
2. node setup-messagenode.js & - sets up and runs all the Messagenode pub servers
3. node setup-roles-as-feed.js - sets up different roles Messagenode can take as a feed, so validators can follow them
4. node join-validator.js - Use validator-invites.json to join validators. All Messagenodes join all validators
5. node subscribe-to-feeds.js - subscribe to all the validator feeds

At this point, Messagenodes are capable of following validators.

#On validator side:

1. node create-txs.js - Create transactions. Each validator creates predefined number of transactions.

#On Messagenode side:

1. node follow-validator.js - Follows the validators. As validators create transactions, they are received by the Messagenodes.
2. node invite.js - create invitations for validators. Produces messagenode-invites.json. Copy this file to “validator” folder. Strictly speaking, Messagenodes don’t need to invite validators to join because as part of the handshake above, each node types follow each other. This invitation file is however generated for subscribing to Messagenode feeds later on.

At this point, Messagenodes are capable of receiving transactions from all validators and build “blocks”.

#On validator side:

1. node subscribe-to-messagenode-feeds.js - This subscribes to feeds created by Messagenodes. With this, validators will be able to collect the “blocks” built by Messagenodes.
2. node follow-messagenode.js - This follows the feeds generated by all the message nodes.

At this point, validators are capable of receiving assembled blocks from all Messagenodes and build “commit blocks”. This completes end to end flow.

For now, there are console.log() messages at every stage of the flow. The APIs to query different data at different validators and message nodes are provided later.

#Data store:

The validator and message node data stores are available at .ssb folder under each of the modules. Under .ssb, each validator has its own folder, such as v1, v2, etc. Similarly message nodes have m1, m2, etc. These folders can be deleted to restart the testing afresh. Deleting these folders cleans up the data and configuration.

